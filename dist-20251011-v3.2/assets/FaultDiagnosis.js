import{M as le}from"./index10.js";import{d as K,r as V,c as M,p as g,q as a,f as l,b as y,t,u as e,n as B,G as se,H as k,D as p,b1 as oe,aa as N,aO as I,F,B as S,b2 as ne,bn as re,aP as G,b5 as de,C as b,bf as O,ap as ie,bo as ue,bp as ce,aA as j,ba as U,e as d,bi as Q,X as fe,S as pe,aF as me}from"./index.js";import{H as W,A as H,z as f,y as Y,B as ve,I as _e,J as R,n as A,E as T,C as ge,D as ye,F as C}from"./index5.js";import{E as c,ai as he}from"./index4.js";import{b as q,c as be,d as $,a as J,E as we}from"./index7.js";import{e as h,f as X,E as D}from"./vnode.js";import{n as Ce}from"./index12.js";import"./index11.js";const De={class:"report-header"},Ee={class:"header-title"},xe={key:0,class:"header-actions"},ke={class:"report-content"},Ve={key:0,class:"intelligent-report"},He={class:"status-overview-section"},Le={class:"status-content"},ze={class:"status-info"},Me={class:"statistic-container"},Ie={class:"statistic-value"},Te={class:"card-footer"},$e={class:"statistic-container"},Be={class:"statistic-value"},Fe={class:"card-footer"},Se={class:"overview-content"},Ue={class:"section-header"},Re={class:"conclusion-content"},Ae={class:"main-diagnosis"},Pe=["innerHTML"],Ne={class:"section-header"},Ge={class:"gas-analysis-grid"},Oe={class:"gas-name"},je={class:"gas-value"},qe={class:"analysis-content"},Je={class:"section-header"},Xe={class:"section-header"},Ke={class:"timeline-detail"},Qe={class:"timeline-detail"},We={class:"section-header"},Ye={key:0,class:"recommendations-list"},Ze={class:"recommendation-priority"},et={class:"recommendation-content"},tt={class:"recommendation-desc"},at={class:"recommendation-status"},lt={class:"section-header"},st={class:"raw-content"},ot={class:"raw-text"},nt={key:1,class:"raw-text-display"},rt={class:"raw-text-pre"},dt=K({__name:"EnhancedDiagnosisReport",props:{reportData:{},isLoading:{type:Boolean}},setup(i){const v=i,E=new le({html:!0,breaks:!0}),n=V(!1),x=V("overview"),L=_=>({危急:{color:"#f56c6c",bgColor:"#fef0f0",icon:U,level:5,text:"危急"},严重:{color:"#f56c6c",bgColor:"#fef0f0",icon:U,level:4,text:"严重"},警告:{color:"#e6a23c",bgColor:"#fdf6ec",icon:U,level:3,text:"警告"},注意:{color:"#409eff",bgColor:"#ecf5ff",icon:j,level:2,text:"注意"},正常:{color:"#67c23a",bgColor:"#f0f9ff",icon:G,level:1,text:"正常"}})[_]||{color:"#909399",bgColor:"#f4f4f5",icon:j,level:0,text:"未知"},m=M(()=>L(v.reportData?.parsed_data?.severity)),o=M(()=>v.reportData);console.log(o);const z=M(()=>{if(!v.reportData?.input_params)return[];const _={H2:"氢气 (H2)",CH4:"甲烷 (CH4)",C2H6:"乙烷 (C2H6)",C2H4:"乙烯 (C2H4)",C2H2:"乙炔 (C2H2)",h2_gas_generation_rate:"H₂ 绝对产气速率",total_hydrocarbons_content:"总烃含量"};return Object.entries(v.reportData.input_params).map(([s,r])=>({name:_[s]||s,value:r,unit:"ppm",key:s}))}),u=M(()=>v.reportData&&v.reportData.parsed_data),P=_=>{console.log(`导出为 ${_}`)},Z=()=>{console.log("分享报告")},ee=()=>{window.print()},te=_=>_?new Date(_).toLocaleString("zh-CN"):"未知";return(_,s)=>(d(),g(e(f),{class:"enhanced-diagnosis-report",shadow:"never"},{header:a(()=>[l("div",De,[l("div",Ee,[t(e(c),{class:"title-icon"},{default:a(()=>[t(e(I))]),_:1}),s[6]||(s[6]=l("span",null,"智能诊断报告",-1)),u.value?(d(),g(e(A),{key:0,color:m.value.bgColor,style:B({color:m.value.color}),size:"small",class:"severity-tag"},{default:a(()=>[b(p(m.value.text),1)]),_:1},8,["color","style"])):k("",!0)]),u.value?(d(),y("div",xe,[t(e(X),{size:"small"},{default:a(()=>[t(e(h),{type:n.value?"default":"primary",onClick:s[0]||(s[0]=r=>n.value=!1)},{default:a(()=>[...s[7]||(s[7]=[b(" 智能报告 ",-1)])]),_:1},8,["type"]),t(e(h),{type:n.value?"primary":"default",onClick:s[1]||(s[1]=r=>n.value=!0)},{default:a(()=>[...s[8]||(s[8]=[b(" 原始数据 ",-1)])]),_:1},8,["type"])]),_:1}),t(e(X),{size:"small",class:"action-buttons"},{default:a(()=>[t(e(T),{content:"刷新数据",placement:"top"},{default:a(()=>[t(e(h),{onClick:s[2]||(s[2]=r=>_.$emit("refresh")),loading:i.isLoading},{default:a(()=>[t(e(c),null,{default:a(()=>[t(e(ie))]),_:1})]),_:1},8,["loading"])]),_:1}),t(e(T),{content:"导出PDF",placement:"top"},{default:a(()=>[t(e(h),{onClick:s[3]||(s[3]=r=>P("pdf"))},{default:a(()=>[t(e(c),null,{default:a(()=>[t(e(O))]),_:1})]),_:1})]),_:1}),t(e(T),{content:"分享报告",placement:"top"},{default:a(()=>[t(e(h),{onClick:Z},{default:a(()=>[t(e(c),null,{default:a(()=>[t(e(ue))]),_:1})]),_:1})]),_:1}),t(e(T),{content:"打印报告",placement:"top"},{default:a(()=>[t(e(h),{onClick:ee},{default:a(()=>[t(e(c),null,{default:a(()=>[t(e(ce))]),_:1})]),_:1})]),_:1})]),_:1})])):k("",!0)])]),default:a(()=>[l("div",ke,[u.value&&!n.value?(d(),y("div",Ve,[l("div",He,[t(e(W),{gutter:16},{default:a(()=>[t(e(H),{span:8},{default:a(()=>[t(e(f),{class:"status-card",shadow:"hover","body-style":{padding:"20px"}},{default:a(()=>[l("div",Le,[l("div",{class:"status-icon",style:B({backgroundColor:m.value.bgColor})},[t(e(c),{color:m.value.color,size:32},{default:a(()=>[(d(),g(se(m.value.icon)))]),_:1},8,["color"])],4),l("div",ze,[s[9]||(s[9]=l("div",{class:"status-title"},"故障状态",-1)),l("div",{class:"status-value",style:B({color:m.value.color})},p(o.value?.parsed_data?.severity||"未知"),5),o.value?.parsed_data?.severity_level?(d(),g(e(q),{key:0,percentage:(o.value?.parsed_data?.severity_level||0)/5*100,color:m.value.color,"show-text":!1,"stroke-width":4,class:"severity-progress"},null,8,["percentage","color"])):k("",!0)])])]),_:1})]),_:1}),t(e(H),{span:8},{default:a(()=>[t(e(f),{class:"info-card",shadow:"hover","body-style":{padding:"20px"}},{default:a(()=>[l("div",Me,[s[10]||(s[10]=l("div",{class:"statistic-title"},"故障类型",-1)),l("div",Ie,p(o.value?.parsed_data?.fault_type||"未检测到明确故障"),1)]),l("div",Te,[t(e(c),{color:"#409eff"},{default:a(()=>[t(e(oe))]),_:1}),s[11]||(s[11]=l("span",{class:"footer-text"},"基于AI智能分析",-1))])]),_:1})]),_:1}),t(e(H),{span:8},{default:a(()=>[t(e(f),{class:"info-card",shadow:"hover","body-style":{padding:"20px"}},{default:a(()=>[l("div",$e,[s[12]||(s[12]=l("div",{class:"statistic-title"},"诊断时间",-1)),l("div",Be,p(te(o.value?.metrics?.diagnosis_time)),1)]),l("div",Fe,[t(e(c),{color:"#67c23a"},{default:a(()=>[t(e(N))]),_:1}),s[13]||(s[13]=l("span",{class:"footer-text"},"实时检测完成",-1))])]),_:1})]),_:1})]),_:1})]),t(e(be),{modelValue:x.value,"onUpdate:modelValue":s[5]||(s[5]=r=>x.value=r),class:"report-tabs"},{default:a(()=>[t(e($),{label:"诊断概览",name:"overview"},{default:a(()=>[l("div",Se,[t(e(f),{class:"conclusion-card",shadow:"never"},{header:a(()=>[l("div",Ue,[t(e(c),null,{default:a(()=>[t(e(I))]),_:1}),s[14]||(s[14]=l("span",null,"主要诊断结论",-1))])]),default:a(()=>[l("div",Re,[l("div",Ae,[l("div",{class:"diagnosis-text",innerHTML:e(E).render(i.reportData?.parsed_data?.main_diagnosis||i.reportData?.summary||"暂无明确诊断结论")},null,8,Pe)]),i.reportData?.parsed_data?.severity_level&&i.reportData.parsed_data.severity_level>=3?(d(),g(e(Y),{key:0,title:`${i.reportData?.parsed_data?.severity}级别故障检测`,type:i.reportData.parsed_data.severity_level>=4?"error":"warning",description:`建议立即采取相应措施，已检测到${i.reportData.parsed_data.severity_level}/5级严重程度的设备异常`,"show-icon":"",closable:!1,class:"severity-alert"},null,8,["title","type","description"])):k("",!0)])]),_:1}),t(e(f),{class:"chart-card",shadow:"never"},{header:a(()=>[l("div",Ne,[t(e(c),null,{default:a(()=>[t(e(ne))]),_:1}),s[15]||(s[15]=l("span",null,"气体浓度分析",-1))])]),default:a(()=>[l("div",Ge,[(d(!0),y(F,null,S(z.value,r=>(d(),y("div",{key:r.key,class:"gas-item"},[l("div",Oe,p(r.name),1),l("div",je,[t(e(we),{value:r.value,suffix:r.key==="h2_gas_generation_rate"?"mL/d":"μL/L","value-style":{color:r.value>100?"#f56c6c":"#303133",fontSize:"18px"}},null,8,["value","suffix","value-style"])]),t(e(q),{percentage:Math.min(r.value/500*100,100),color:r.value>100?"#f56c6c":r.value>50?"#e6a23c":"#67c23a","show-text":!1,"stroke-width":6},null,8,["percentage","color"])]))),128))])]),_:1})])]),_:1}),t(e($),{label:"详细分析",name:"analysis"},{default:a(()=>[l("div",qe,[t(e(f),{class:"metrics-card",shadow:"never"},{header:a(()=>[l("div",Je,[t(e(c),null,{default:a(()=>[t(e(re))]),_:1}),s[16]||(s[16]=l("span",null,"技术指标",-1))])]),default:a(()=>[t(e(ve),{column:2,border:""},{default:a(()=>[(d(!0),y(F,null,S(i.reportData?.metrics||{},(r,w)=>(d(),g(e(ge),{key:w,label:String(w).replace(/_/g," ").replace(/\b\w/g,ae=>ae.toUpperCase())},{default:a(()=>[l("div",null,p(r),1)]),_:2},1032,["label"]))),128))]),_:1})]),_:1}),t(e(f),{class:"timeline-card",shadow:"never"},{header:a(()=>[l("div",Xe,[t(e(c),null,{default:a(()=>[t(e(N))]),_:1}),s[17]||(s[17]=l("span",null,"分析过程",-1))])]),default:a(()=>[t(e(_e),null,{default:a(()=>[t(e(R),{timestamp:"数据采集",placement:"top"},{default:a(()=>[t(e(f),null,{default:a(()=>[s[18]||(s[18]=l("p",null,"获取设备气体浓度参数",-1)),l("p",Ke," 共采集 "+p(z.value?.length||0)+" 项气体指标数据 ",1)]),_:1})]),_:1}),t(e(R),{timestamp:"智能分析",placement:"top"},{default:a(()=>[t(e(f),null,{default:a(()=>[...s[19]||(s[19]=[l("p",null,"AI模型进行故障模式识别",-1),l("p",{class:"timeline-detail"},"应用多种诊断算法进行综合判断",-1)])]),_:1})]),_:1}),t(e(R),{timestamp:"结果生成",placement:"top",icon:e(G),color:"#67c23a"},{default:a(()=>[t(e(f),null,{default:a(()=>[s[20]||(s[20]=l("p",null,"生成诊断报告和建议措施",-1)),l("p",Qe," 检测状态: "+p(i.reportData?.parsed_data?.severity||"未知"),1)]),_:1})]),_:1},8,["icon"])]),_:1})]),_:1})])]),_:1}),t(e($),{label:"建议措施",name:"recommendations"},{default:a(()=>[t(e(f),{class:"recommendations-card",shadow:"never"},{header:a(()=>[l("div",We,[t(e(c),null,{default:a(()=>[t(e(de))]),_:1}),s[21]||(s[21]=l("span",null,"操作建议",-1)),i.reportData?.parsed_data?.recommendations?.length?(d(),g(e(A),{key:0,type:"info",size:"small"},{default:a(()=>[b(p(i.reportData.parsed_data.recommendations.length)+" 项建议 ",1)]),_:1})):k("",!0)])]),default:a(()=>[i.reportData?.parsed_data?.recommendations?.length?(d(),y("div",Ye,[(d(!0),y(F,null,S(i.reportData?.parsed_data?.recommendations||[],(r,w)=>(d(),y("div",{key:w,class:"recommendation-item"},[l("div",Ze,[t(e(A),{type:w<2?"danger":w<4?"warning":"info",size:"small"},{default:a(()=>[b(" 优先级 "+p(w+1),1)]),_:2},1032,["type"])]),l("div",et,[l("h4",null,p(r),1),l("p",tt," 基于当前"+p(i.reportData?.parsed_data?.severity||"未知")+"级别故障状态的专业建议 ",1)]),l("div",at,[t(e(h),{size:"small",type:"primary",plain:""},{default:a(()=>[...s[22]||(s[22]=[b(" 标记已执行 ",-1)])]),_:1})])]))),128))])):(d(),g(e(J),{key:1,description:"暂无具体建议措施"}))]),_:1})]),_:1}),t(e($),{label:"原始数据",name:"raw"},{default:a(()=>[t(e(f),{class:"raw-data-card",shadow:"never"},{header:a(()=>[l("div",lt,[t(e(c),null,{default:a(()=>[t(e(I))]),_:1}),s[24]||(s[24]=l("span",null,"完整报告",-1)),t(e(h),{size:"small",onClick:s[4]||(s[4]=r=>P("txt"))},{default:a(()=>[t(e(c),null,{default:a(()=>[t(e(O))]),_:1}),s[23]||(s[23]=b(" 导出文本 ",-1))]),_:1})])]),default:a(()=>[l("div",st,[l("pre",ot,p(i.reportData?.raw_text||""),1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):u.value&&n.value?(d(),y("div",nt,[t(e(f),{shadow:"never"},{default:a(()=>[l("pre",rt,p(o.value?.raw_text||""),1)]),_:1})])):(d(),g(e(J),{key:2,description:"暂无诊断结果，请先进行故障诊断",class:"empty-state"},{image:a(()=>[t(e(c),{size:"64",color:"#c0c4cc"},{default:a(()=>[t(e(I))]),_:1})]),description:a(()=>[...s[25]||(s[25]=[l("p",null,'点击左侧"开始诊断"按钮获取智能分析报告',-1)])]),_:1}))])]),_:1}))}}),it=Q(dt,[["__scopeId","data-v-88527d08"]]),ut={class:"fault-diagnosis-page"},ct=K({__name:"FaultDiagnosis",setup(i){const v=V(!1),E=V(null),n=fe({total_hydrocarbons_content:160,h2_gas_generation_rate:160,c2h2:10,c2h4:140,c2h6:150,h2:150,ch4:149}),x=V(null),L=async()=>{v.value=!0,E.value=null,x.value=null;try{const m=await Ce(n);x.value=m,he.success("诊断接口调用成功！")}catch(m){E.value=m.message||"诊断过程中发生未知错误。"}finally{v.value=!1}};return(m,o)=>{const z=me("loading");return pe((d(),y("div",ut,[t(e(W),{gutter:24},{default:a(()=>[t(e(H),{span:10},{default:a(()=>[t(e(f),{class:"input-card",shadow:"never"},{header:a(()=>[...o[7]||(o[7]=[l("div",{class:"card-header"},[l("span",null,"故障参数输入")],-1)])]),default:a(()=>[t(e(ye),{model:n,"label-width":"160px","label-position":"right"},{default:a(()=>[t(e(C),{label:"H2 (μL/L)"},{default:a(()=>[t(e(D),{modelValue:n.h2,"onUpdate:modelValue":o[0]||(o[0]=u=>n.h2=u),modelModifiers:{number:!0},type:"number",placeholder:"请输入 H2 气体含量"},null,8,["modelValue"])]),_:1}),t(e(C),{label:"CH4 (μL/L)"},{default:a(()=>[t(e(D),{modelValue:n.ch4,"onUpdate:modelValue":o[1]||(o[1]=u=>n.ch4=u),modelModifiers:{number:!0},type:"number",placeholder:"请输入 CH4 浓度"},null,8,["modelValue"])]),_:1}),t(e(C),{label:"C2H6 (μL/L)"},{default:a(()=>[t(e(D),{modelValue:n.c2h6,"onUpdate:modelValue":o[2]||(o[2]=u=>n.c2h6=u),modelModifiers:{number:!0},type:"number",placeholder:"请输入 C2H6 浓度"},null,8,["modelValue"])]),_:1}),t(e(C),{label:"C2H4 (μL/L)"},{default:a(()=>[t(e(D),{modelValue:n.c2h4,"onUpdate:modelValue":o[3]||(o[3]=u=>n.c2h4=u),modelModifiers:{number:!0},type:"number",placeholder:"请输入 C2H4 浓度"},null,8,["modelValue"])]),_:1}),t(e(C),{label:"C2H2 (μL/L)"},{default:a(()=>[t(e(D),{modelValue:n.c2h2,"onUpdate:modelValue":o[4]||(o[4]=u=>n.c2h2=u),modelModifiers:{number:!0},type:"number",placeholder:"请输入 C2H2 浓度"},null,8,["modelValue"])]),_:1}),t(e(C),{label:"H₂绝对产气速率(mL/d)"},{default:a(()=>[t(e(D),{modelValue:n.h2_gas_generation_rate,"onUpdate:modelValue":o[5]||(o[5]=u=>n.h2_gas_generation_rate=u),modelModifiers:{number:!0},type:"number",placeholder:"H₂ 绝对产气速率"},null,8,["modelValue"])]),_:1}),t(e(C),{label:"总烃含量(μL/L)"},{default:a(()=>[t(e(D),{modelValue:n.total_hydrocarbons_content,"onUpdate:modelValue":o[6]||(o[6]=u=>n.total_hydrocarbons_content=u),modelModifiers:{number:!0},type:"number",placeholder:"总烃含量"},null,8,["modelValue"])]),_:1}),t(e(h),{type:"primary",onClick:L,style:{width:"100%","margin-top":"10px"},size:"large"},{default:a(()=>[...o[8]||(o[8]=[b("开始诊断",-1)])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(e(H),{span:14},{default:a(()=>[t(it,{"report-data":x.value,"is-loading":v.value,onRefresh:L},null,8,["report-data","is-loading"])]),_:1})]),_:1}),E.value?(d(),g(e(Y),{key:0,title:E.value,type:"error","show-icon":"",closable:!1,style:{"margin-top":"24px"}},null,8,["title"])):k("",!0)])),[[z,v.value]])}}}),bt=Q(ct,[["__scopeId","data-v-4737a231"]]);export{bt as default};
