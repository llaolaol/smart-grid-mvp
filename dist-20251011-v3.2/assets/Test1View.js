import{d as de,r as p,c as A,o as ue,b as d,t,p as b,H as x,q as l,f as a,ah as r,C as _,F as D,B as S,D as f,u as O,A as E,bg as ce,bf as _e,e as n,bi as pe}from"./index.js";import{E as fe,L as me}from"./EnhancedFaultTree.js";import{a as ve}from"./index12.js";import{ai as m}from"./index4.js";import"./index11.js";const ge={class:"test1-view"},ye={class:"control-item"},he={key:0,class:"control-item"},ke={key:0,class:"control-item"},we={class:"logic-gates-status-horizontal"},be={class:"gate-status-item-small"},xe={key:0,class:"more-gates"},Ce={key:1,class:"control-item"},Ne={class:"json-header"},je={class:"header-actions"},De={key:0,class:"loading-container",style:{height:"calc(100vh - 350px)"}},Se={class:"loading-content"},Oe={key:1,class:"json-content",style:{height:"calc(100vh - 350px)"}},Te={class:"json-text"},Je={key:2,class:"empty-state",style:{height:"calc(100vh - 350px)"}},Ve={key:0,class:"loading-container",style:{height:"calc(100vh - 300px)"}},Re={class:"loading-content"},ze={key:1,class:"fault-tree-wrapper"},Le={key:2,class:"empty-state"},Ue={key:0,class:"diagnosis-result"},Be={class:"diagnosis-path"},Ae={class:"reasoning-process",style:{"margin-top":"20px"}},Ee={class:"timeline-content"},Ie={class:"step-title"},Pe={class:"step-condition"},Fe={class:"step-reasoning"},$e={class:"dialog-footer"},Me=de({__name:"Test1View",setup(We){const h=p("workflow");p(null);const C=p("transformer_fault");p(!1);const T=p(!1),k=p(!1),u=p(null),L=p(void 0),J=p(null),v=p(null),I=p(),P=[{label:"åŸºç¡€é€»è¾‘é—¨ç¤ºä¾‹",value:"basic"},{label:"å¤æ‚æ•…éšœæ ‘ç¤ºä¾‹",value:"complex"},{label:"å˜ç”µç«™é€»è¾‘æ¨ç†",value:"substation"},{label:"å˜å‹å™¨æ•…éšœç±»å‹è¯Šæ–­",value:"transformer_fault"}],U=A(()=>u.value||L.value),w=A(()=>J.value?.logic_gates||[]);ue(()=>{g()});const F=o=>{k.value=!1,o==="sample"?(C.value="transformer_fault",u.value||g()):o==="workflow"&&(u.value||g())},$=o=>{u.value||g()},M=()=>{C.value="transformer_fault",u.value||g()},g=async()=>{k.value=!0;try{const o=await ve({mindmap:"å˜å‹å™¨æ•…éšœç±»å‹è¯Šæ–­PlantUMLä»£ç ",prompt:"æç¤ºè¯",feedback:"åé¦ˆ",auto_evaluated:!1,llm_config:{model:"æ¨¡å‹åç§°",api_key:"é‰´æƒç§˜é’¥",base_url:"è¯·æ±‚åœ°å€",temperature:.1,top_p:.1}});if(o.data){let e=null;const i=o.data;i["data-ft_json"]?e=i["data-ft_json"]:i.ft_json?e=i.ft_json:i.data&&i.data.ft_json&&(e=i.data.ft_json),e?(u.value={ftree_json:e},J.value=null,m.success("æ•…éšœæ ‘æ•°æ®ä»APIåŠ è½½å®Œæˆ")):(u.value={ftree_json:o.data},J.value=null,m.success("æ•…éšœæ ‘æ•°æ®ä»APIåŠ è½½å®Œæˆ"))}else throw new Error("APIè¿”å›æ•°æ®æ ¼å¼ä¸æ­£ç¡®")}catch{m.error("æ— æ³•ä»APIåŠ è½½æ•°æ®ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAPIé…ç½®")}finally{k.value=!1}},W=o=>{console.log("ğŸ–±ï¸ Test1ViewèŠ‚ç‚¹ç‚¹å‡»:",o)},G=o=>{console.log("ğŸ–±ï¸ Test1ViewèŠ‚ç‚¹åŒå‡»:",o)},q=o=>{console.log("è¯Šæ–­å®Œæˆ:",o),m.success("è¯Šæ–­åˆ†æå®Œæˆ")},H=()=>{if(v.value){const o=JSON.stringify(v.value,null,2),e=new Blob([o],{type:"application/json"}),i=URL.createObjectURL(e),c=document.createElement("a");c.href=i,c.download=`diagnosis_result_${new Date().getTime()}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i),m.success("ç»“æœå¯¼å‡ºæˆåŠŸ")}},K=o=>o.includes("æ­£å¸¸")?"success":o.includes("æ³¨æ„")?"warning":o.includes("æ•…éšœ")?"danger":"info",Q=o=>{if(!o)return"";try{return JSON.stringify(o,null,2)}catch{return"æ— æ³•æ ¼å¼åŒ–JSONæ•°æ®"}},X=async()=>{if(!u.value){m.warning("æ²¡æœ‰å¯å¤åˆ¶çš„JSONæ•°æ®");return}try{const o=JSON.stringify(u.value,null,2);await navigator.clipboard.writeText(o),m.success("JSONæ•°æ®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{m.error("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¤åˆ¶")}},Y=()=>{if(!u.value){m.warning("æ²¡æœ‰å¯ä¸‹è½½çš„JSONæ•°æ®");return}try{const o=JSON.stringify(u.value,null,2),e=new Blob([o],{type:"application/json"}),i=URL.createObjectURL(e),c=document.createElement("a");c.href=i,c.download=`workflow_data_${new Date().getTime()}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i),m.success("JSONæ•°æ®ä¸‹è½½æˆåŠŸ")}catch{m.error("ä¸‹è½½å¤±è´¥")}};return(o,e)=>{const i=r("el-card"),c=r("el-radio-button"),Z=r("el-radio-group"),V=r("el-col"),ee=r("el-option"),te=r("el-select"),le=r("el-tooltip"),N=r("el-tag"),oe=r("el-row"),j=r("el-icon"),y=r("el-button"),se=r("el-scrollbar"),B=r("el-empty"),R=r("el-descriptions-item"),ae=r("el-descriptions"),ne=r("el-timeline-item"),ie=r("el-timeline"),re=r("el-dialog");return n(),d("div",ge,[t(i,{class:"header-card",shadow:"never"},{default:l(()=>[...e[4]||(e[4]=[a("h1",null,"é€»è¾‘é—¨æ•…éšœæ ‘æµ‹è¯•é¡µé¢",-1)])]),_:1}),t(i,{class:"control-panel-top",style:{"margin-top":"20px"}},{default:l(()=>[t(oe,{gutter:20,align:"middle"},{default:l(()=>[t(V,{span:6},{default:l(()=>[a("div",ye,[e[7]||(e[7]=a("h4",null,"æ•°æ®æº",-1)),t(Z,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=s=>h.value=s),onChange:F,size:"small"},{default:l(()=>[t(c,{value:"workflow"},{default:l(()=>[...e[5]||(e[5]=[_("Workflow JSON",-1)])]),_:1}),t(c,{value:"sample"},{default:l(()=>[...e[6]||(e[6]=[_("ç¤ºä¾‹æ•°æ®",-1)])]),_:1})]),_:1},8,["modelValue"])])]),_:1}),t(V,{span:10},{default:l(()=>[h.value==="sample"?(n(),d("div",he,[e[8]||(e[8]=a("h4",null,"ç¤ºä¾‹æ•°æ®",-1)),t(te,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=s=>C.value=s),onChange:$,style:{width:"300px"},size:"small"},{default:l(()=>[(n(),d(D,null,S(P,s=>t(ee,{key:s.value,label:s.label,value:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])):x("",!0)]),_:1}),t(V,{span:8},{default:l(()=>[w.value.length>0?(n(),d("div",ke,[a("h4",null,"é€»è¾‘é—¨çŠ¶æ€ ("+f(w.value.length)+"ä¸ª)",1),a("div",we,[(n(!0),d(D,null,S(w.value.slice(0,5),s=>(n(),b(le,{key:s.id,content:`${s.name}: ${s.condition||"æ— æ¡ä»¶"}`,placement:"bottom"},{default:l(()=>[a("div",be,[t(me,{"gate-type":s.gate_type,state:s.state,size:"small",interactive:!1},null,8,["gate-type","state"])])]),_:2},1032,["content"]))),128)),w.value.length>5?(n(),d("span",xe,"+"+f(w.value.length-5)+"ä¸ª",1)):x("",!0)])])):(n(),d("div",Ce,[e[9]||(e[9]=a("h4",null,"ç³»ç»ŸçŠ¶æ€",-1)),t(N,{type:"info",size:"small"},{default:l(()=>[_(f(U.value?"æ•°æ®å·²åŠ è½½":"ç­‰å¾…åŠ è½½æ•°æ®"),1)]),_:1})]))]),_:1})]),_:1})]),_:1}),h.value==="workflow"?(n(),b(i,{key:0,class:"json-display-card",style:{"margin-top":"20px",height:"calc(100vh - 250px)"}},{header:l(()=>[a("div",Ne,[e[12]||(e[12]=a("span",null,"Workflow JSON æ•°æ®",-1)),a("div",je,[t(y,{size:"small",onClick:X},{default:l(()=>[t(j,null,{default:l(()=>[t(O(ce))]),_:1}),e[10]||(e[10]=_(" å¤åˆ¶JSON ",-1))]),_:1}),t(y,{size:"small",onClick:Y},{default:l(()=>[t(j,null,{default:l(()=>[t(O(_e))]),_:1}),e[11]||(e[11]=_(" ä¸‹è½½JSON ",-1))]),_:1})])])]),default:l(()=>[k.value?(n(),d("div",De,[a("div",Se,[t(j,{class:"loading-spinner",size:"48"},{default:l(()=>[t(O(E))]),_:1}),e[13]||(e[13]=a("p",{class:"loading-text"},"æ­£åœ¨åŠ è½½JSONæ•°æ®...",-1))])])):u.value?(n(),d("div",Oe,[t(se,{height:"100%"},{default:l(()=>[a("pre",Te,f(Q(u.value)),1)]),_:1})])):(n(),d("div",Je,[t(B,{description:"æš‚æ— JSONæ•°æ®","image-size":120},{default:l(()=>[t(y,{type:"primary",onClick:g},{default:l(()=>[...e[14]||(e[14]=[_(" åŠ è½½æ•°æ® ",-1)])]),_:1})]),_:1})]))]),_:1})):x("",!0),h.value==="sample"?(n(),b(i,{key:1,class:"tree-display-full",style:{"margin-top":"20px",height:"calc(100vh - 250px)",overflow:"hidden",border:"none"}},{default:l(()=>[k.value?(n(),d("div",Ve,[a("div",Re,[t(j,{class:"loading-spinner",size:"48"},{default:l(()=>[t(O(E))]),_:1}),e[15]||(e[15]=a("p",{class:"loading-text"},"æ­£åœ¨æ„å»ºæ•…éšœæ ‘...",-1))])])):U.value?(n(),d("div",ze,[t(fe,{ref_key:"faultTreeRef",ref:I,"workflow-data":u.value,"fault-tree-data":L.value,onNodeClick:W,onNodeDoubleClick:G,onDiagnosisComplete:q},null,8,["workflow-data","fault-tree-data"])])):(n(),d("div",Le,[t(B,{description:"è¯·é€‰æ‹©æ•°æ®æºå¹¶åŠ è½½æ•°æ®","image-size":120},{default:l(()=>[t(y,{type:"primary",onClick:M},{default:l(()=>[...e[16]||(e[16]=[_(" åŠ è½½é»˜è®¤ç¤ºä¾‹ ",-1)])]),_:1})]),_:1})]))]),_:1})):x("",!0),t(re,{modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=s=>T.value=s),title:"è¯Šæ–­ç»“æœ",width:"700px","close-on-click-modal":!1},{footer:l(()=>[a("span",$e,[t(y,{onClick:e[2]||(e[2]=s=>T.value=!1)},{default:l(()=>[...e[18]||(e[18]=[_("å…³é—­",-1)])]),_:1}),t(y,{type:"primary",onClick:H},{default:l(()=>[...e[19]||(e[19]=[_("å¯¼å‡ºç»“æœ",-1)])]),_:1})])]),default:l(()=>[v.value?(n(),d("div",Ue,[t(ae,{column:2,border:""},{default:l(()=>[t(R,{label:"æ€»ä½“ç»“è®º"},{default:l(()=>[t(N,{type:K(v.value.conclusion)},{default:l(()=>[_(f(v.value.conclusion),1)]),_:1},8,["type"])]),_:1}),t(R,{label:"ç½®ä¿¡åº¦"},{default:l(()=>[_(f((v.value.confidence*100).toFixed(1))+"% ",1)]),_:1}),t(R,{label:"è¯Šæ–­è·¯å¾„",span:2},{default:l(()=>[a("div",Be,[(n(!0),d(D,null,S(v.value.path,(s,z)=>(n(),b(N,{key:z,size:"small",style:{"margin-right":"8px","margin-bottom":"4px"}},{default:l(()=>[_(f(s),1)]),_:2},1024))),128))])]),_:1})]),_:1}),a("div",Ae,[e[17]||(e[17]=a("h4",null,"æ¨ç†è¿‡ç¨‹",-1)),t(ie,null,{default:l(()=>[(n(!0),d(D,null,S(v.value.steps,(s,z)=>(n(),b(ne,{key:z,type:s.result?"success":"danger"},{default:l(()=>[a("div",Ee,[a("div",Ie,[a("strong",null,f(s.gateName),1),t(N,{size:"small",type:s.result?"success":"danger"},{default:l(()=>[_(f(s.result?"çœŸ":"å‡"),1)]),_:2},1032,["type"])]),a("div",Pe,"æ¡ä»¶: "+f(s.condition),1),a("div",Fe,"æ¨ç†: "+f(s.reasoning),1)])]),_:2},1032,["type"]))),128))]),_:1})])])):x("",!0)]),_:1},8,["modelValue"])])}}}),Xe=pe(Me,[["__scopeId","data-v-3598f29a"]]);export{Xe as default};
