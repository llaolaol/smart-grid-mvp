import{d as q,r as b,b as A,t as e,p as k,q as t,f as i,ah as n,C as _,u as E,az as M,e as V,bi as D}from"./index.js";import{a as L}from"./index12.js";import{E as z}from"./EnhancedFaultTree.js";import{ai as c}from"./index4.js";import{c as N}from"./index8.js";import"./index11.js";import"./vnode.js";import"./scroll.js";const R={class:"fault-tree-generation"},G={style:{position:"absolute",top:"10px",right:"10px","z-index":"100"}},H={style:{height:"1200px","min-height":"800px",width:"100%","min-width":"1400px"}},J={class:"empty-state"},K=q({__name:"FaultTreeGeneration",setup(O){const a=b({mindmap:"",prompt:"",feedback:"",auto_evaluated:!1,llm_config:{model:"",api_key:"",base_url:"",temperature:.1,top_p:.1}}),w={mindmap:[{required:!0,message:"请输入思维导图内容",trigger:"blur"}],prompt:[{required:!0,message:"请输入生成提示词",trigger:"blur"}],"llm_config.model":[{required:!0,message:"请输入模型名称",trigger:"blur"}],"llm_config.api_key":[{required:!0,message:"请输入API密钥",trigger:"blur"}],"llm_config.base_url":[{required:!0,message:"请输入API地址",trigger:"blur"}]},m=b(),y=b(!1),f=b(null),h=async()=>{if(m.value){try{if(!await m.value.validate())return}catch{return}y.value=!0;try{const d=await L(a.value);if(d.data){const l=d.data;let r=null;l["data-ft_json"]?r=l["data-ft_json"]:l.ft_json?r=l.ft_json:l.data&&l.data.ft_json?r=l.data.ft_json:r=l,f.value=r,c.success("故障树生成成功！")}else c.error("生成失败：未收到有效数据")}catch(d){console.error("生成故障树失败:",d),c.error("生成故障树失败，请检查配置参数")}finally{y.value=!1}}},T=()=>{m.value&&m.value.resetFields(),f.value=null},U=()=>{a.value={mindmap:"变压器故障类型诊断PlantUML代码",prompt:"基于变压器故障诊断知识，生成专业的故障树结构",feedback:"请确保包含主要的故障类型和诊断逻辑",auto_evaluated:!1,llm_config:{model:"gpt-3.5-turbo",api_key:"your-api-key-here",base_url:"https://api.openai.com/v1",temperature:.1,top_p:.1}},c.info("已加载预设数据，请修改API密钥后生成")},F=async()=>{if(f.value)try{await N.confirm("是否要保存当前生成的故障树到故障树管理中？","保存确认",{confirmButtonText:"保存",cancelButtonText:"取消",type:"info"}),c.success("故障树保存成功！")}catch{}};return(d,l)=>{const r=n("el-card"),p=n("el-input"),u=n("el-form-item"),s=n("el-col"),g=n("el-row"),P=n("el-switch"),C=n("el-divider"),x=n("el-slider"),B=n("el-icon"),v=n("el-button"),I=n("el-form"),j=n("el-empty");return V(),A("div",R,[e(r,{class:"header-card",shadow:"never"},{default:t(()=>[...l[9]||(l[9]=[i("h1",null,"故障树生成",-1),i("p",{style:{color:"#606266","margin-top":"8px"}},"基于文档内容生成专业的故障树结构",-1)])]),_:1}),e(r,{style:{"margin-top":"20px"}},{header:t(()=>[...l[10]||(l[10]=[i("span",null,"生成参数配置",-1)])]),default:t(()=>[e(I,{model:a.value,"label-width":"120px",rules:w,ref_key:"formRef",ref:m},{default:t(()=>[e(g,{gutter:20},{default:t(()=>[e(s,{span:12},{default:t(()=>[e(u,{label:"思维导图内容",prop:"mindmap"},{default:t(()=>[e(p,{modelValue:a.value.mindmap,"onUpdate:modelValue":l[0]||(l[0]=o=>a.value.mindmap=o),type:"textarea",rows:4,placeholder:"请输入思维导图PlantUML代码或选择预设内容"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:t(()=>[e(u,{label:"生成提示词",prop:"prompt"},{default:t(()=>[e(p,{modelValue:a.value.prompt,"onUpdate:modelValue":l[1]||(l[1]=o=>a.value.prompt=o),type:"textarea",rows:4,placeholder:"请输入生成故障树的提示词"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:20},{default:t(()=>[e(s,{span:12},{default:t(()=>[e(u,{label:"反馈信息",prop:"feedback"},{default:t(()=>[e(p,{modelValue:a.value.feedback,"onUpdate:modelValue":l[2]||(l[2]=o=>a.value.feedback=o),placeholder:"可选：提供反馈信息以优化生成结果"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:t(()=>[e(u,{label:"自动评估"},{default:t(()=>[e(P,{modelValue:a.value.auto_evaluated,"onUpdate:modelValue":l[3]||(l[3]=o=>a.value.auto_evaluated=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{"content-position":"left"},{default:t(()=>[...l[11]||(l[11]=[_("LLM配置",-1)])]),_:1}),e(g,{gutter:20},{default:t(()=>[e(s,{span:8},{default:t(()=>[e(u,{label:"模型名称",prop:"llm_config.model"},{default:t(()=>[e(p,{modelValue:a.value.llm_config.model,"onUpdate:modelValue":l[4]||(l[4]=o=>a.value.llm_config.model=o),placeholder:"如：gpt-3.5-turbo"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:8},{default:t(()=>[e(u,{label:"API密钥",prop:"llm_config.api_key"},{default:t(()=>[e(p,{modelValue:a.value.llm_config.api_key,"onUpdate:modelValue":l[5]||(l[5]=o=>a.value.llm_config.api_key=o),type:"password","show-password":"",placeholder:"请输入API密钥"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:8},{default:t(()=>[e(u,{label:"API地址",prop:"llm_config.base_url"},{default:t(()=>[e(p,{modelValue:a.value.llm_config.base_url,"onUpdate:modelValue":l[6]||(l[6]=o=>a.value.llm_config.base_url=o),placeholder:"如：https://api.openai.com/v1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:20},{default:t(()=>[e(s,{span:12},{default:t(()=>[e(u,{label:"温度参数"},{default:t(()=>[e(x,{modelValue:a.value.llm_config.temperature,"onUpdate:modelValue":l[7]||(l[7]=o=>a.value.llm_config.temperature=o),min:0,max:1,step:.1,"show-input":""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:t(()=>[e(u,{label:"Top-p参数"},{default:t(()=>[e(x,{modelValue:a.value.llm_config.top_p,"onUpdate:modelValue":l[8]||(l[8]=o=>a.value.llm_config.top_p=o),min:0,max:1,step:.1,"show-input":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(v,{type:"primary",onClick:h,loading:y.value},{default:t(()=>[e(B,null,{default:t(()=>[e(E(M))]),_:1}),l[12]||(l[12]=_(" 生成故障树 ",-1))]),_:1},8,["loading"]),e(v,{onClick:T},{default:t(()=>[...l[13]||(l[13]=[_("重置",-1)])]),_:1}),e(v,{onClick:U},{default:t(()=>[...l[14]||(l[14]=[_("使用预设数据",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),f.value?(V(),k(r,{key:0,style:{"margin-top":"20px","min-height":"600px",border:"none"}},{default:t(()=>[i("div",G,[e(v,{type:"primary",size:"small",onClick:F},{default:t(()=>[...l[15]||(l[15]=[_(" 保存故障树 ",-1)])]),_:1})]),i("div",H,[e(z,{"fault-tree-data":f.value,"show-toolbar":!0,interactive:!0,style:{height:"100%",width:"100%","min-width":"1400px"}},null,8,["fault-tree-data"])])]),_:1})):(V(),k(r,{key:1,style:{"margin-top":"20px","min-height":"400px"}},{default:t(()=>[i("div",J,[e(j,{description:"配置参数并点击生成按钮来创建故障树"})])]),_:1}))])}}}),le=D(K,[["__scopeId","data-v-3752a8f9"]]);export{le as default};
